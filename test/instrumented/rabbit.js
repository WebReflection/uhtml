function cov_2i457qu7rf(){var path="/home/ag/git/uhtml/esm/rabbit.js";var hash="c469dd539aabadab59dbc68eecb40072a68a6437";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/ag/git/uhtml/esm/rabbit.js",statementMap:{"0":{start:{line:9,column:15},end:{line:9,column:20}},"1":{start:{line:10,column:18},end:{line:10,column:29}},"2":{start:{line:12,column:20},end:{line:15,column:1}},"3":{start:{line:13,column:29},end:{line:13,column:55}},"4":{start:{line:14,column:2},end:{line:14,column:56}},"5":{start:{line:17,column:20},end:{line:59,column:1}},"6":{start:{line:18,column:15},end:{line:18,column:43}},"7":{start:{line:19,column:18},end:{line:19,column:44}},"8":{start:{line:20,column:13},end:{line:20,column:34}},"9":{start:{line:21,column:16},end:{line:21,column:18}},"10":{start:{line:22,column:17},end:{line:22,column:36}},"11":{start:{line:23,column:10},end:{line:23,column:11}},"12":{start:{line:24,column:15},end:{line:24,column:30}},"13":{start:{line:25,column:2},end:{line:57,column:3}},"14":{start:{line:26,column:17},end:{line:26,column:30}},"15":{start:{line:27,column:4},end:{line:28,column:36}},"16":{start:{line:28,column:6},end:{line:28,column:36}},"17":{start:{line:29,column:4},end:{line:56,column:5}},"18":{start:{line:33,column:6},end:{line:36,column:7}},"19":{start:{line:34,column:8},end:{line:34,column:59}},"20":{start:{line:35,column:8},end:{line:35,column:35}},"21":{start:{line:39,column:6},end:{line:48,column:7}},"22":{start:{line:40,column:8},end:{line:45,column:11}},"23":{start:{line:46,column:8},end:{line:46,column:37}},"24":{start:{line:47,column:8},end:{line:47,column:35}},"25":{start:{line:49,column:6},end:{line:55,column:7}},"26":{start:{line:53,column:8},end:{line:53,column:59}},"27":{start:{line:54,column:8},end:{line:54,column:35}},"28":{start:{line:58,column:2},end:{line:58,column:26}},"29":{start:{line:61,column:19},end:{line:66,column:1}},"30":{start:{line:62,column:27},end:{line:62,column:81}},"31":{start:{line:63,column:19},end:{line:63,column:59}},"32":{start:{line:64,column:18},end:{line:64,column:47}},"33":{start:{line:65,column:2},end:{line:65,column:38}},"34":{start:{line:68,column:24},end:{line:81,column:1}},"35":{start:{line:69,column:23},end:{line:69,column:27}},"36":{start:{line:70,column:18},end:{line:73,column:3}},"37":{start:{line:74,column:15},end:{line:74,column:42}},"38":{start:{line:75,column:35},end:{line:75,column:42}},"39":{start:{line:76,column:2},end:{line:77,column:18}},"40":{start:{line:77,column:4},end:{line:77,column:18}},"41":{start:{line:78,column:2},end:{line:79,column:20}},"42":{start:{line:79,column:4},end:{line:79,column:20}},"43":{start:{line:80,column:2},end:{line:80,column:14}},"44":{start:{line:83,column:20},end:{line:87,column:1}},"45":{start:{line:84,column:17},end:{line:84,column:44}},"46":{start:{line:85,column:2},end:{line:85,column:34}},"47":{start:{line:86,column:2},end:{line:86,column:16}},"48":{start:{line:89,column:15},end:{line:105,column:1}},"49":{start:{line:90,column:18},end:{line:90,column:22}},"50":{start:{line:91,column:23},end:{line:91,column:30}},"51":{start:{line:92,column:35},end:{line:92,column:39}},"52":{start:{line:93,column:18},end:{line:93,column:31}},"53":{start:{line:94,column:2},end:{line:95,column:62}},"54":{start:{line:95,column:4},end:{line:95,column:62}},"55":{start:{line:96,column:2},end:{line:96,column:14}},"56":{start:{line:97,column:2},end:{line:97,column:37}},"57":{start:{line:98,column:14},end:{line:98,column:22}},"58":{start:{line:99,column:2},end:{line:100,column:53}},"59":{start:{line:100,column:4},end:{line:100,column:53}},"60":{start:{line:101,column:35},end:{line:101,column:40}},"61":{start:{line:102,column:2},end:{line:103,column:26}},"62":{start:{line:102,column:15},end:{line:102,column:16}},"63":{start:{line:102,column:29},end:{line:102,column:36}},"64":{start:{line:103,column:4},end:{line:103,column:26}},"65":{start:{line:104,column:2},end:{line:104,column:52}},"66":{start:{line:107,column:20},end:{line:132,column:1}},"67":{start:{line:108,column:21},end:{line:108,column:28}},"68":{start:{line:109,column:2},end:{line:129,column:3}},"69":{start:{line:109,column:15},end:{line:109,column:16}},"70":{start:{line:109,column:29},end:{line:109,column:35}},"71":{start:{line:109,column:45},end:{line:109,column:49}},"72":{start:{line:110,column:17},end:{line:110,column:26}},"73":{start:{line:114,column:4},end:{line:127,column:5}},"74":{start:{line:115,column:6},end:{line:115,column:46}},"75":{start:{line:128,column:4},end:{line:128,column:8}},"76":{start:{line:130,column:2},end:{line:130,column:16}},"77":{start:{line:131,column:2},end:{line:131,column:28}},"78":{start:{line:142,column:2},end:{line:142,column:19}},"79":{start:{line:143,column:2},end:{line:143,column:27}},"80":{start:{line:144,column:2},end:{line:144,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:20},end:{line:12,column:21}},loc:{start:{line:12,column:40},end:{line:15,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:20},end:{line:17,column:21}},loc:{start:{line:17,column:40},end:{line:59,column:1}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:61,column:19},end:{line:61,column:20}},loc:{start:{line:61,column:39},end:{line:66,column:1}},line:61},"3":{name:"(anonymous_3)",decl:{start:{line:68,column:24},end:{line:68,column:25}},loc:{start:{line:68,column:40},end:{line:81,column:1}},line:68},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:20},end:{line:83,column:21}},loc:{start:{line:83,column:40},end:{line:87,column:1}},line:83},"5":{name:"(anonymous_5)",decl:{start:{line:89,column:15},end:{line:89,column:16}},loc:{start:{line:89,column:40},end:{line:105,column:1}},line:89},"6":{name:"(anonymous_6)",decl:{start:{line:107,column:20},end:{line:107,column:21}},loc:{start:{line:107,column:47},end:{line:132,column:1}},line:107},"7":{name:"Hole",decl:{start:{line:141,column:16},end:{line:141,column:20}},loc:{start:{line:141,column:45},end:{line:145,column:1}},line:141}},branchMap:{"0":{loc:{start:{line:27,column:4},end:{line:28,column:36}},type:"if",locations:[{start:{line:27,column:4},end:{line:28,column:36}},{start:{line:27,column:4},end:{line:28,column:36}}],line:27},"1":{loc:{start:{line:29,column:4},end:{line:56,column:5}},type:"if",locations:[{start:{line:29,column:4},end:{line:56,column:5}},{start:{line:29,column:4},end:{line:56,column:5}}],line:29},"2":{loc:{start:{line:33,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:33,column:6},end:{line:36,column:7}}],line:33},"3":{loc:{start:{line:49,column:6},end:{line:55,column:7}},type:"if",locations:[{start:{line:49,column:6},end:{line:55,column:7}},{start:{line:49,column:6},end:{line:55,column:7}}],line:49},"4":{loc:{start:{line:50,column:8},end:{line:51,column:54}},type:"binary-expr",locations:[{start:{line:50,column:8},end:{line:50,column:50}},{start:{line:51,column:8},end:{line:51,column:54}}],line:50},"5":{loc:{start:{line:62,column:27},end:{line:62,column:81}},type:"binary-expr",locations:[{start:{line:62,column:27},end:{line:62,column:50}},{start:{line:62,column:54},end:{line:62,column:81}}],line:62},"6":{loc:{start:{line:76,column:2},end:{line:77,column:18}},type:"if",locations:[{start:{line:76,column:2},end:{line:77,column:18}},{start:{line:76,column:2},end:{line:77,column:18}}],line:76},"7":{loc:{start:{line:78,column:2},end:{line:79,column:20}},type:"if",locations:[{start:{line:78,column:2},end:{line:79,column:20}},{start:{line:78,column:2},end:{line:79,column:20}}],line:78},"8":{loc:{start:{line:94,column:2},end:{line:95,column:62}},type:"if",locations:[{start:{line:94,column:2},end:{line:95,column:62}},{start:{line:94,column:2},end:{line:95,column:62}}],line:94},"9":{loc:{start:{line:99,column:2},end:{line:100,column:53}},type:"if",locations:[{start:{line:99,column:2},end:{line:100,column:53}},{start:{line:99,column:2},end:{line:100,column:53}}],line:99},"10":{loc:{start:{line:99,column:6},end:{line:99,column:70}},type:"binary-expr",locations:[{start:{line:99,column:6},end:{line:99,column:14}},{start:{line:99,column:19},end:{line:99,column:46}},{start:{line:99,column:50},end:{line:99,column:69}}],line:99},"11":{loc:{start:{line:104,column:9},end:{line:104,column:51}},type:"binary-expr",locations:[{start:{line:104,column:9},end:{line:104,column:13}},{start:{line:104,column:18},end:{line:104,column:50}}],line:104},"12":{loc:{start:{line:114,column:4},end:{line:127,column:5}},type:"if",locations:[{start:{line:114,column:4},end:{line:127,column:5}}],line:114}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c469dd539aabadab59dbc68eecb40072a68a6437"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2i457qu7rf=function(){return actualCoverage;};return actualCoverage;}cov_2i457qu7rf();import instrument from '../../node_modules/uparser/esm/index.js';import{isArray}from '../../node_modules/uarray/esm/index.js';import{persistent}from './uwire.js';import{cacheInfo}from'./cache.js';import{handlers}from'./handlers.js';import{createFragment,createPath,createWalker,importNode}from'./node.js';const prefix=(cov_2i457qu7rf().s[0]++,'isÂµ');const templates=(cov_2i457qu7rf().s[1]++,new WeakMap());cov_2i457qu7rf().s[2]++;const createEntry=(type,template)=>{cov_2i457qu7rf().f[0]++;const{content,updates}=(cov_2i457qu7rf().s[3]++,mapUpdates(type,template));cov_2i457qu7rf().s[4]++;return{type,template,content,updates,wire:null};};cov_2i457qu7rf().s[5]++;const mapTemplate=(type,template)=>{cov_2i457qu7rf().f[1]++;const text=(cov_2i457qu7rf().s[6]++,instrument(template,prefix));const content=(cov_2i457qu7rf().s[7]++,createFragment(text,type));const tw=(cov_2i457qu7rf().s[8]++,createWalker(content));const nodes=(cov_2i457qu7rf().s[9]++,[]);const length=(cov_2i457qu7rf().s[10]++,template.length-1);let i=(cov_2i457qu7rf().s[11]++,0);let search=(cov_2i457qu7rf().s[12]++,`${prefix}${i}`);cov_2i457qu7rf().s[13]++;while(i<length){const node=(cov_2i457qu7rf().s[14]++,tw.nextNode());cov_2i457qu7rf().s[15]++;if(!node){cov_2i457qu7rf().b[0][0]++;cov_2i457qu7rf().s[16]++;throw`bad template: ${text}`;}else{cov_2i457qu7rf().b[0][1]++;}cov_2i457qu7rf().s[17]++;if(node.nodeType===8){cov_2i457qu7rf().b[1][0]++;cov_2i457qu7rf().s[18]++;// The only comments to be considered are those
// which content is exactly the same as the searched one.
/* istanbul ignore else */if(node.textContent===search){cov_2i457qu7rf().b[2][0]++;cov_2i457qu7rf().s[19]++;nodes.push({type:'node',path:createPath(node)});cov_2i457qu7rf().s[20]++;search=`${prefix}${++i}`;}else{}}else{cov_2i457qu7rf().b[1][1]++;cov_2i457qu7rf().s[21]++;while(node.hasAttribute(search)){cov_2i457qu7rf().s[22]++;nodes.push({type:'attr',path:createPath(node),name:node.getAttribute(search)// svg: type === 'svg'
});cov_2i457qu7rf().s[23]++;node.removeAttribute(search);cov_2i457qu7rf().s[24]++;search=`${prefix}${++i}`;}cov_2i457qu7rf().s[25]++;if((cov_2i457qu7rf().b[4][0]++,/^(?:style|textarea)$/i.test(node.tagName))&&(cov_2i457qu7rf().b[4][1]++,node.textContent.trim()===`<!--${search}-->`)){cov_2i457qu7rf().b[3][0]++;cov_2i457qu7rf().s[26]++;nodes.push({type:'text',path:createPath(node)});cov_2i457qu7rf().s[27]++;search=`${prefix}${++i}`;}else{cov_2i457qu7rf().b[3][1]++;}}}cov_2i457qu7rf().s[28]++;return{content,nodes};};cov_2i457qu7rf().s[29]++;const mapUpdates=(type,template)=>{cov_2i457qu7rf().f[2]++;const{content,nodes}=(cov_2i457qu7rf().s[30]++,(cov_2i457qu7rf().b[5][0]++,templates.get(template))||(cov_2i457qu7rf().b[5][1]++,setTemplate(type,template)));const fragment=(cov_2i457qu7rf().s[31]++,importNode.call(document,content,true));const updates=(cov_2i457qu7rf().s[32]++,nodes.map(handlers,fragment));cov_2i457qu7rf().s[33]++;return{content:fragment,updates};};cov_2i457qu7rf().s[34]++;export const retrieve=(info,hole)=>{cov_2i457qu7rf().f[3]++;const{sub,stack}=(cov_2i457qu7rf().s[35]++,info);const counter=(cov_2i457qu7rf().s[36]++,{a:0,aLength:sub.length,i:0,iLength:stack.length});const wire=(cov_2i457qu7rf().s[37]++,unroll(info,hole,counter));const{a,i,aLength,iLength}=(cov_2i457qu7rf().s[38]++,counter);cov_2i457qu7rf().s[39]++;if(a<aLength){cov_2i457qu7rf().b[6][0]++;cov_2i457qu7rf().s[40]++;sub.splice(a);}else{cov_2i457qu7rf().b[6][1]++;}cov_2i457qu7rf().s[41]++;if(i<iLength){cov_2i457qu7rf().b[7][0]++;cov_2i457qu7rf().s[42]++;stack.splice(i);}else{cov_2i457qu7rf().b[7][1]++;}cov_2i457qu7rf().s[43]++;return wire;};cov_2i457qu7rf().s[44]++;const setTemplate=(type,template)=>{cov_2i457qu7rf().f[4]++;const result=(cov_2i457qu7rf().s[45]++,mapTemplate(type,template));cov_2i457qu7rf().s[46]++;templates.set(template,result);cov_2i457qu7rf().s[47]++;return result;};cov_2i457qu7rf().s[48]++;const unroll=(info,hole,counter)=>{cov_2i457qu7rf().f[5]++;const{stack}=(cov_2i457qu7rf().s[49]++,info);const{i,iLength}=(cov_2i457qu7rf().s[50]++,counter);const{type,template,values}=(cov_2i457qu7rf().s[51]++,hole);const unknown=(cov_2i457qu7rf().s[52]++,i===iLength);cov_2i457qu7rf().s[53]++;if(unknown){cov_2i457qu7rf().b[8][0]++;cov_2i457qu7rf().s[54]++;counter.iLength=stack.push(createEntry(type,template));}else{cov_2i457qu7rf().b[8][1]++;}cov_2i457qu7rf().s[55]++;counter.i++;cov_2i457qu7rf().s[56]++;unrollArray(info,values,counter);let entry=(cov_2i457qu7rf().s[57]++,stack[i]);cov_2i457qu7rf().s[58]++;if((cov_2i457qu7rf().b[10][0]++,!unknown)&&((cov_2i457qu7rf().b[10][1]++,entry.template!==template)||(cov_2i457qu7rf().b[10][2]++,entry.type!==type))){cov_2i457qu7rf().b[9][0]++;cov_2i457qu7rf().s[59]++;stack[i]=entry=createEntry(type,template);}else{cov_2i457qu7rf().b[9][1]++;}const{content,updates,wire}=(cov_2i457qu7rf().s[60]++,entry);cov_2i457qu7rf().s[61]++;for(let i=(cov_2i457qu7rf().s[62]++,0),{length}=(cov_2i457qu7rf().s[63]++,updates);i<length;i++){cov_2i457qu7rf().s[64]++;updates[i](values[i]);}cov_2i457qu7rf().s[65]++;return(cov_2i457qu7rf().b[11][0]++,wire)||(cov_2i457qu7rf().b[11][1]++,entry.wire=persistent(content));};cov_2i457qu7rf().s[66]++;const unrollArray=(info,values,counter)=>{cov_2i457qu7rf().f[6]++;let{a,aLength}=(cov_2i457qu7rf().s[67]++,counter);cov_2i457qu7rf().s[68]++;for(let i=(cov_2i457qu7rf().s[69]++,0),{length}=(cov_2i457qu7rf().s[70]++,values),{sub}=(cov_2i457qu7rf().s[71]++,info);i<length;i++){const hole=(cov_2i457qu7rf().s[72]++,values[i]);// The only values to process are Hole and arrays.
// Accordingly, there is no `else` case to test.
/* istanbul ignore else */cov_2i457qu7rf().s[73]++;if(hole instanceof Hole){cov_2i457qu7rf().b[12][0]++;cov_2i457qu7rf().s[74]++;values[i]=unroll(info,hole,counter);}else{if(isArray(hole)){const{length}=hole;const next=a+length;while(aLength<next)aLength=sub.push(null);for(let i=0;i<length;i++){const inner=hole[i];if(inner instanceof Hole)hole[i]=retrieve(sub[a]||(sub[a]=cacheInfo()),inner);a++;}}}cov_2i457qu7rf().s[75]++;a++;}cov_2i457qu7rf().s[76]++;counter.a=a;cov_2i457qu7rf().s[77]++;counter.aLength=aLength;};/**
 * Holds all necessary details needed to render the content further on. 
 * @constructor
 * @param {string} type The hole type, either `html` or `svg`.
 * @param {string[]} template The template literals used to the define the content.
 * @param {Array} values Zero, one, or more interpolated values to render.
 */export function Hole(type,template,values){cov_2i457qu7rf().f[7]++;cov_2i457qu7rf().s[78]++;this.type=type;cov_2i457qu7rf().s[79]++;this.template=template;cov_2i457qu7rf().s[80]++;this.values=values;};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJhYmJpdC5qcyJdLCJuYW1lcyI6WyJpbnN0cnVtZW50IiwiaXNBcnJheSIsInBlcnNpc3RlbnQiLCJjYWNoZUluZm8iLCJoYW5kbGVycyIsImNyZWF0ZUZyYWdtZW50IiwiY3JlYXRlUGF0aCIsImNyZWF0ZVdhbGtlciIsImltcG9ydE5vZGUiLCJwcmVmaXgiLCJ0ZW1wbGF0ZXMiLCJXZWFrTWFwIiwiY3JlYXRlRW50cnkiLCJ0eXBlIiwidGVtcGxhdGUiLCJjb250ZW50IiwidXBkYXRlcyIsIm1hcFVwZGF0ZXMiLCJ3aXJlIiwibWFwVGVtcGxhdGUiLCJ0ZXh0IiwidHciLCJub2RlcyIsImxlbmd0aCIsImkiLCJzZWFyY2giLCJub2RlIiwibmV4dE5vZGUiLCJub2RlVHlwZSIsInRleHRDb250ZW50IiwicHVzaCIsInBhdGgiLCJoYXNBdHRyaWJ1dGUiLCJuYW1lIiwiZ2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwidGVzdCIsInRhZ05hbWUiLCJ0cmltIiwiZ2V0Iiwic2V0VGVtcGxhdGUiLCJmcmFnbWVudCIsImNhbGwiLCJkb2N1bWVudCIsIm1hcCIsInJldHJpZXZlIiwiaW5mbyIsImhvbGUiLCJzdWIiLCJzdGFjayIsImNvdW50ZXIiLCJhIiwiYUxlbmd0aCIsImlMZW5ndGgiLCJ1bnJvbGwiLCJzcGxpY2UiLCJyZXN1bHQiLCJzZXQiLCJ2YWx1ZXMiLCJ1bmtub3duIiwidW5yb2xsQXJyYXkiLCJlbnRyeSIsIkhvbGUiLCJuZXh0IiwiaW5uZXIiXSwibWFwcGluZ3MiOiIwN1NBQUEsTUFBT0EsQ0FBQUEsVUFBUCxLQUF1QixTQUF2QixDQUNBLE9BQVFDLE9BQVIsS0FBc0IsUUFBdEIsQ0FDQSxPQUFRQyxVQUFSLEtBQXlCLE9BQXpCLENBRUEsT0FBUUMsU0FBUixLQUF3QixZQUF4QixDQUNBLE9BQVFDLFFBQVIsS0FBdUIsZUFBdkIsQ0FDQSxPQUFRQyxjQUFSLENBQXdCQyxVQUF4QixDQUFvQ0MsWUFBcEMsQ0FBa0RDLFVBQWxELEtBQW1FLFdBQW5FLENBRUEsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBRyxLQUFILENBQVosQ0FDQSxLQUFNQyxDQUFBQSxTQUFTLDBCQUFHLEdBQUlDLENBQUFBLE9BQUosRUFBSCxDQUFmLEMsd0JBRUEsS0FBTUMsQ0FBQUEsV0FBVyxDQUFHLENBQUNDLElBQUQsQ0FBT0MsUUFBUCxHQUFvQix5QkFDdEMsS0FBTSxDQUFDQyxPQUFELENBQVVDLE9BQVYsMkJBQXFCQyxVQUFVLENBQUNKLElBQUQsQ0FBT0MsUUFBUCxDQUEvQixDQUFOLENBRHNDLHdCQUV0QyxNQUFPLENBQUNELElBQUQsQ0FBT0MsUUFBUCxDQUFpQkMsT0FBakIsQ0FBMEJDLE9BQTFCLENBQW1DRSxJQUFJLENBQUUsSUFBekMsQ0FBUCxDQUNELENBSEQsQyx3QkFLQSxLQUFNQyxDQUFBQSxXQUFXLENBQUcsQ0FBQ04sSUFBRCxDQUFPQyxRQUFQLEdBQW9CLHlCQUN0QyxLQUFNTSxDQUFBQSxJQUFJLDBCQUFHcEIsVUFBVSxDQUFDYyxRQUFELENBQVdMLE1BQVgsQ0FBYixDQUFWLENBQ0EsS0FBTU0sQ0FBQUEsT0FBTywwQkFBR1YsY0FBYyxDQUFDZSxJQUFELENBQU9QLElBQVAsQ0FBakIsQ0FBYixDQUNBLEtBQU1RLENBQUFBLEVBQUUsMEJBQUdkLFlBQVksQ0FBQ1EsT0FBRCxDQUFmLENBQVIsQ0FDQSxLQUFNTyxDQUFBQSxLQUFLLDBCQUFHLEVBQUgsQ0FBWCxDQUNBLEtBQU1DLENBQUFBLE1BQU0sMkJBQUdULFFBQVEsQ0FBQ1MsTUFBVCxDQUFrQixDQUFyQixDQUFaLENBQ0EsR0FBSUMsQ0FBQUEsQ0FBQywyQkFBRyxDQUFILENBQUwsQ0FDQSxHQUFJQyxDQUFBQSxNQUFNLDJCQUFJLEdBQUVoQixNQUFPLEdBQUVlLENBQUUsRUFBakIsQ0FBVixDQVBzQyx5QkFRdEMsTUFBT0EsQ0FBQyxDQUFHRCxNQUFYLENBQW1CLENBQ2pCLEtBQU1HLENBQUFBLElBQUksMkJBQUdMLEVBQUUsQ0FBQ00sUUFBSCxFQUFILENBQVYsQ0FEaUIseUJBRWpCLEdBQUksQ0FBQ0QsSUFBTCxDQUNFLDBEQUFPLGlCQUFnQk4sSUFBSyxFQUE1QixDQUE4QixDQURoQyxpQ0FGaUIseUJBSWpCLEdBQUlNLElBQUksQ0FBQ0UsUUFBTCxHQUFrQixDQUF0QixDQUF5QixxREFDdkI7QUFDQTtBQUNBLDBCQUNBLEdBQUlGLElBQUksQ0FBQ0csV0FBTCxHQUFxQkosTUFBekIsQ0FBaUMscURBQy9CSCxLQUFLLENBQUNRLElBQU4sQ0FBVyxDQUFDakIsSUFBSSxDQUFFLE1BQVAsQ0FBZWtCLElBQUksQ0FBRXpCLFVBQVUsQ0FBQ29CLElBQUQsQ0FBL0IsQ0FBWCxFQUQrQix5QkFFL0JELE1BQU0sQ0FBSSxHQUFFaEIsTUFBTyxHQUFFLEVBQUVlLENBQUUsRUFBekIsQ0FDRCxDQUhELE1BSUQsQ0FSRCxJQVNLLHFEQUNILE1BQU9FLElBQUksQ0FBQ00sWUFBTCxDQUFrQlAsTUFBbEIsQ0FBUCxDQUFrQywwQkFDaENILEtBQUssQ0FBQ1EsSUFBTixDQUFXLENBQ1RqQixJQUFJLENBQUUsTUFERyxDQUVUa0IsSUFBSSxDQUFFekIsVUFBVSxDQUFDb0IsSUFBRCxDQUZQLENBR1RPLElBQUksQ0FBRVAsSUFBSSxDQUFDUSxZQUFMLENBQWtCVCxNQUFsQixDQUNOO0FBSlMsQ0FBWCxFQURnQyx5QkFPaENDLElBQUksQ0FBQ1MsZUFBTCxDQUFxQlYsTUFBckIsRUFQZ0MseUJBUWhDQSxNQUFNLENBQUksR0FBRWhCLE1BQU8sR0FBRSxFQUFFZSxDQUFFLEVBQXpCLENBQ0QsQ0FWRSx5QkFXSCxHQUNFLG9EQUF3QlksSUFBeEIsQ0FBNkJWLElBQUksQ0FBQ1csT0FBbEMsZ0NBQ0FYLElBQUksQ0FBQ0csV0FBTCxDQUFpQlMsSUFBakIsS0FBNkIsT0FBTWIsTUFBTyxLQUQxQyxDQURGLENBR0MscURBQ0NILEtBQUssQ0FBQ1EsSUFBTixDQUFXLENBQUNqQixJQUFJLENBQUUsTUFBUCxDQUFla0IsSUFBSSxDQUFFekIsVUFBVSxDQUFDb0IsSUFBRCxDQUEvQixDQUFYLEVBREQseUJBRUNELE1BQU0sQ0FBSSxHQUFFaEIsTUFBTyxHQUFFLEVBQUVlLENBQUUsRUFBekIsQ0FDRCxDQU5ELGlDQU9ELENBQ0YsQ0F4Q3FDLHlCQXlDdEMsTUFBTyxDQUFDVCxPQUFELENBQVVPLEtBQVYsQ0FBUCxDQUNELENBMUNELEMseUJBNENBLEtBQU1MLENBQUFBLFVBQVUsQ0FBRyxDQUFDSixJQUFELENBQU9DLFFBQVAsR0FBb0IseUJBQ3JDLEtBQU0sQ0FBQ0MsT0FBRCxDQUFVTyxLQUFWLDRCQUFtQiw0QkFBQVosU0FBUyxDQUFDNkIsR0FBVixDQUFjekIsUUFBZCxnQ0FBMkIwQixXQUFXLENBQUMzQixJQUFELENBQU9DLFFBQVAsQ0FBdEMsQ0FBbkIsQ0FBTixDQUNBLEtBQU0yQixDQUFBQSxRQUFRLDJCQUFHakMsVUFBVSxDQUFDa0MsSUFBWCxDQUFnQkMsUUFBaEIsQ0FBMEI1QixPQUExQixDQUFtQyxJQUFuQyxDQUFILENBQWQsQ0FDQSxLQUFNQyxDQUFBQSxPQUFPLDJCQUFHTSxLQUFLLENBQUNzQixHQUFOLENBQVV4QyxRQUFWLENBQW9CcUMsUUFBcEIsQ0FBSCxDQUFiLENBSHFDLHlCQUlyQyxNQUFPLENBQUMxQixPQUFPLENBQUUwQixRQUFWLENBQW9CekIsT0FBcEIsQ0FBUCxDQUNELENBTEQsQyx5QkFPQSxNQUFPLE1BQU02QixDQUFBQSxRQUFRLENBQUcsQ0FBQ0MsSUFBRCxDQUFPQyxJQUFQLEdBQWdCLHlCQUN0QyxLQUFNLENBQUNDLEdBQUQsQ0FBTUMsS0FBTiw0QkFBZUgsSUFBZixDQUFOLENBQ0EsS0FBTUksQ0FBQUEsT0FBTywyQkFBRyxDQUNkQyxDQUFDLENBQUUsQ0FEVyxDQUNSQyxPQUFPLENBQUVKLEdBQUcsQ0FBQ3pCLE1BREwsQ0FFZEMsQ0FBQyxDQUFFLENBRlcsQ0FFUjZCLE9BQU8sQ0FBRUosS0FBSyxDQUFDMUIsTUFGUCxDQUFILENBQWIsQ0FJQSxLQUFNTCxDQUFBQSxJQUFJLDJCQUFHb0MsTUFBTSxDQUFDUixJQUFELENBQU9DLElBQVAsQ0FBYUcsT0FBYixDQUFULENBQVYsQ0FDQSxLQUFNLENBQUNDLENBQUQsQ0FBSTNCLENBQUosQ0FBTzRCLE9BQVAsQ0FBZ0JDLE9BQWhCLDRCQUEyQkgsT0FBM0IsQ0FBTixDQVBzQyx5QkFRdEMsR0FBSUMsQ0FBQyxDQUFHQyxPQUFSLENBQ0UscURBQUFKLEdBQUcsQ0FBQ08sTUFBSixDQUFXSixDQUFYLEVBQWMsQ0FEaEIsaUNBUnNDLHlCQVV0QyxHQUFJM0IsQ0FBQyxDQUFHNkIsT0FBUixDQUNFLHFEQUFBSixLQUFLLENBQUNNLE1BQU4sQ0FBYS9CLENBQWIsRUFBZ0IsQ0FEbEIsaUNBVnNDLHlCQVl0QyxNQUFPTixDQUFBQSxJQUFQLENBQ0QsQ0FiTSxDLHlCQWVQLEtBQU1zQixDQUFBQSxXQUFXLENBQUcsQ0FBQzNCLElBQUQsQ0FBT0MsUUFBUCxHQUFvQix5QkFDdEMsS0FBTTBDLENBQUFBLE1BQU0sMkJBQUdyQyxXQUFXLENBQUNOLElBQUQsQ0FBT0MsUUFBUCxDQUFkLENBQVosQ0FEc0MseUJBRXRDSixTQUFTLENBQUMrQyxHQUFWLENBQWMzQyxRQUFkLENBQXdCMEMsTUFBeEIsRUFGc0MseUJBR3RDLE1BQU9BLENBQUFBLE1BQVAsQ0FDRCxDQUpELEMseUJBTUEsS0FBTUYsQ0FBQUEsTUFBTSxDQUFHLENBQUNSLElBQUQsQ0FBT0MsSUFBUCxDQUFhRyxPQUFiLEdBQXlCLHlCQUN0QyxLQUFNLENBQUNELEtBQUQsNEJBQVVILElBQVYsQ0FBTixDQUNBLEtBQU0sQ0FBQ3RCLENBQUQsQ0FBSTZCLE9BQUosNEJBQWVILE9BQWYsQ0FBTixDQUNBLEtBQU0sQ0FBQ3JDLElBQUQsQ0FBT0MsUUFBUCxDQUFpQjRDLE1BQWpCLDRCQUEyQlgsSUFBM0IsQ0FBTixDQUNBLEtBQU1ZLENBQUFBLE9BQU8sMkJBQUduQyxDQUFDLEdBQUs2QixPQUFULENBQWIsQ0FKc0MseUJBS3RDLEdBQUlNLE9BQUosQ0FDRSxxREFBQVQsT0FBTyxDQUFDRyxPQUFSLENBQWtCSixLQUFLLENBQUNuQixJQUFOLENBQVdsQixXQUFXLENBQUNDLElBQUQsQ0FBT0MsUUFBUCxDQUF0QixDQUFsQixDQUEwRCxDQUQ1RCxpQ0FMc0MseUJBT3RDb0MsT0FBTyxDQUFDMUIsQ0FBUixHQVBzQyx5QkFRdENvQyxXQUFXLENBQUNkLElBQUQsQ0FBT1ksTUFBUCxDQUFlUixPQUFmLENBQVgsQ0FDQSxHQUFJVyxDQUFBQSxLQUFLLDJCQUFHWixLQUFLLENBQUN6QixDQUFELENBQVIsQ0FBVCxDQVRzQyx5QkFVdEMsR0FBSSw4QkFBQ21DLE9BQUQsSUFBYSw2QkFBQUUsS0FBSyxDQUFDL0MsUUFBTixHQUFtQkEsUUFBbkIsZ0NBQStCK0MsS0FBSyxDQUFDaEQsSUFBTixHQUFlQSxJQUE5QyxDQUFiLENBQUosQ0FDRSxxREFBQW9DLEtBQUssQ0FBQ3pCLENBQUQsQ0FBTCxDQUFZcUMsS0FBSyxDQUFHakQsV0FBVyxDQUFDQyxJQUFELENBQU9DLFFBQVAsQ0FBL0IsQ0FBaUQsQ0FEbkQsaUNBRUEsS0FBTSxDQUFDQyxPQUFELENBQVVDLE9BQVYsQ0FBbUJFLElBQW5CLDRCQUEyQjJDLEtBQTNCLENBQU4sQ0Fac0MseUJBYXRDLElBQUssR0FBSXJDLENBQUFBLENBQUMsMkJBQUcsQ0FBSCxDQUFMLENBQVcsQ0FBQ0QsTUFBRCw0QkFBV1AsT0FBWCxDQUFoQixDQUFvQ1EsQ0FBQyxDQUFHRCxNQUF4QyxDQUFnREMsQ0FBQyxFQUFqRCxDQUNFLDBCQUFBUixPQUFPLENBQUNRLENBQUQsQ0FBUCxDQUFXa0MsTUFBTSxDQUFDbEMsQ0FBRCxDQUFqQixFQUFzQixDQWRjLHlCQWV0QyxNQUFPLDZCQUFBTixJQUFJLGdDQUFLMkMsS0FBSyxDQUFDM0MsSUFBTixDQUFhaEIsVUFBVSxDQUFDYSxPQUFELENBQTVCLENBQVgsQ0FDRCxDQWhCRCxDLHlCQWtCQSxLQUFNNkMsQ0FBQUEsV0FBVyxDQUFHLENBQUNkLElBQUQsQ0FBT1ksTUFBUCxDQUFlUixPQUFmLEdBQTJCLHlCQUM3QyxHQUFJLENBQUNDLENBQUQsQ0FBSUMsT0FBSiw0QkFBZUYsT0FBZixDQUFKLENBRDZDLHlCQUU3QyxJQUFLLEdBQUkxQixDQUFBQSxDQUFDLDJCQUFHLENBQUgsQ0FBTCxDQUFXLENBQUNELE1BQUQsNEJBQVdtQyxNQUFYLENBQVgsQ0FBOEIsQ0FBQ1YsR0FBRCw0QkFBUUYsSUFBUixDQUFuQyxDQUFpRHRCLENBQUMsQ0FBR0QsTUFBckQsQ0FBNkRDLENBQUMsRUFBOUQsQ0FBa0UsQ0FDaEUsS0FBTXVCLENBQUFBLElBQUksMkJBQUdXLE1BQU0sQ0FBQ2xDLENBQUQsQ0FBVCxDQUFWLENBQ0E7QUFDQTtBQUNBLDBCQUpnRSx5QkFLaEUsR0FBSXVCLElBQUksV0FBWWUsQ0FBQUEsSUFBcEIsQ0FDRSxzREFBQUosTUFBTSxDQUFDbEMsQ0FBRCxDQUFOLENBQVk4QixNQUFNLENBQUNSLElBQUQsQ0FBT0MsSUFBUCxDQUFhRyxPQUFiLENBQWxCLENBQXdDLENBRDFDLElBRUssSUFBSWpELE9BQU8sQ0FBQzhDLElBQUQsQ0FBWCxDQUFtQixDQUN0QixLQUFNLENBQUN4QixNQUFELEVBQVd3QixJQUFqQixDQUNBLEtBQU1nQixDQUFBQSxJQUFJLENBQUdaLENBQUMsQ0FBRzVCLE1BQWpCLENBQ0EsTUFBTzZCLE9BQU8sQ0FBR1csSUFBakIsQ0FDRVgsT0FBTyxDQUFHSixHQUFHLENBQUNsQixJQUFKLENBQVMsSUFBVCxDQUFWLENBQ0YsSUFBSyxHQUFJTixDQUFBQSxDQUFDLENBQUcsQ0FBYixDQUFnQkEsQ0FBQyxDQUFHRCxNQUFwQixDQUE0QkMsQ0FBQyxFQUE3QixDQUFpQyxDQUMvQixLQUFNd0MsQ0FBQUEsS0FBSyxDQUFHakIsSUFBSSxDQUFDdkIsQ0FBRCxDQUFsQixDQUNBLEdBQUl3QyxLQUFLLFdBQVlGLENBQUFBLElBQXJCLENBQ0VmLElBQUksQ0FBQ3ZCLENBQUQsQ0FBSixDQUFVcUIsUUFBUSxDQUFDRyxHQUFHLENBQUNHLENBQUQsQ0FBSCxHQUFXSCxHQUFHLENBQUNHLENBQUQsQ0FBSCxDQUFTaEQsU0FBUyxFQUE3QixDQUFELENBQW1DNkQsS0FBbkMsQ0FBbEIsQ0FDRmIsQ0FBQyxHQUNGLENBQ0YsRUFsQitELHlCQW1CaEVBLENBQUMsR0FDRixDQXRCNEMseUJBdUI3Q0QsT0FBTyxDQUFDQyxDQUFSLENBQVlBLENBQVosQ0F2QjZDLHlCQXdCN0NELE9BQU8sQ0FBQ0UsT0FBUixDQUFrQkEsT0FBbEIsQ0FDRCxDQXpCRCxDQTJCQTs7Ozs7O0dBT0EsTUFBTyxTQUFTVSxDQUFBQSxJQUFULENBQWNqRCxJQUFkLENBQW9CQyxRQUFwQixDQUE4QjRDLE1BQTlCLENBQXNDLGtEQUMzQyxLQUFLN0MsSUFBTCxDQUFZQSxJQUFaLENBRDJDLHlCQUUzQyxLQUFLQyxRQUFMLENBQWdCQSxRQUFoQixDQUYyQyx5QkFHM0MsS0FBSzRDLE1BQUwsQ0FBY0EsTUFBZCxDQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGluc3RydW1lbnQgZnJvbSAndXBhcnNlcic7XG5pbXBvcnQge2lzQXJyYXl9IGZyb20gJ3VhcnJheSc7XG5pbXBvcnQge3BlcnNpc3RlbnR9IGZyb20gJ3V3aXJlJztcblxuaW1wb3J0IHtjYWNoZUluZm99IGZyb20gJy4vY2FjaGUuanMnO1xuaW1wb3J0IHtoYW5kbGVyc30gZnJvbSAnLi9oYW5kbGVycy5qcyc7XG5pbXBvcnQge2NyZWF0ZUZyYWdtZW50LCBjcmVhdGVQYXRoLCBjcmVhdGVXYWxrZXIsIGltcG9ydE5vZGV9IGZyb20gJy4vbm9kZS5qcyc7XG5cbmNvbnN0IHByZWZpeCA9ICdpc8K1JztcbmNvbnN0IHRlbXBsYXRlcyA9IG5ldyBXZWFrTWFwO1xuXG5jb25zdCBjcmVhdGVFbnRyeSA9ICh0eXBlLCB0ZW1wbGF0ZSkgPT4ge1xuICBjb25zdCB7Y29udGVudCwgdXBkYXRlc30gPSBtYXBVcGRhdGVzKHR5cGUsIHRlbXBsYXRlKTtcbiAgcmV0dXJuIHt0eXBlLCB0ZW1wbGF0ZSwgY29udGVudCwgdXBkYXRlcywgd2lyZTogbnVsbH07XG59O1xuXG5jb25zdCBtYXBUZW1wbGF0ZSA9ICh0eXBlLCB0ZW1wbGF0ZSkgPT4ge1xuICBjb25zdCB0ZXh0ID0gaW5zdHJ1bWVudCh0ZW1wbGF0ZSwgcHJlZml4KTtcbiAgY29uc3QgY29udGVudCA9IGNyZWF0ZUZyYWdtZW50KHRleHQsIHR5cGUpO1xuICBjb25zdCB0dyA9IGNyZWF0ZVdhbGtlcihjb250ZW50KTtcbiAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgY29uc3QgbGVuZ3RoID0gdGVtcGxhdGUubGVuZ3RoIC0gMTtcbiAgbGV0IGkgPSAwO1xuICBsZXQgc2VhcmNoID0gYCR7cHJlZml4fSR7aX1gO1xuICB3aGlsZSAoaSA8IGxlbmd0aCkge1xuICAgIGNvbnN0IG5vZGUgPSB0dy5uZXh0Tm9kZSgpO1xuICAgIGlmICghbm9kZSlcbiAgICAgIHRocm93IGBiYWQgdGVtcGxhdGU6ICR7dGV4dH1gO1xuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSA4KSB7XG4gICAgICAvLyBUaGUgb25seSBjb21tZW50cyB0byBiZSBjb25zaWRlcmVkIGFyZSB0aG9zZVxuICAgICAgLy8gd2hpY2ggY29udGVudCBpcyBleGFjdGx5IHRoZSBzYW1lIGFzIHRoZSBzZWFyY2hlZCBvbmUuXG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG5vZGUudGV4dENvbnRlbnQgPT09IHNlYXJjaCkge1xuICAgICAgICBub2Rlcy5wdXNoKHt0eXBlOiAnbm9kZScsIHBhdGg6IGNyZWF0ZVBhdGgobm9kZSl9KTtcbiAgICAgICAgc2VhcmNoID0gYCR7cHJlZml4fSR7KytpfWA7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgd2hpbGUgKG5vZGUuaGFzQXR0cmlidXRlKHNlYXJjaCkpIHtcbiAgICAgICAgbm9kZXMucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ2F0dHInLFxuICAgICAgICAgIHBhdGg6IGNyZWF0ZVBhdGgobm9kZSksXG4gICAgICAgICAgbmFtZTogbm9kZS5nZXRBdHRyaWJ1dGUoc2VhcmNoKSxcbiAgICAgICAgICAvLyBzdmc6IHR5cGUgPT09ICdzdmcnXG4gICAgICAgIH0pO1xuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShzZWFyY2gpO1xuICAgICAgICBzZWFyY2ggPSBgJHtwcmVmaXh9JHsrK2l9YDtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgL14oPzpzdHlsZXx0ZXh0YXJlYSkkL2kudGVzdChub2RlLnRhZ05hbWUpICYmXG4gICAgICAgIG5vZGUudGV4dENvbnRlbnQudHJpbSgpID09PSBgPCEtLSR7c2VhcmNofS0tPmBcbiAgICAgICl7XG4gICAgICAgIG5vZGVzLnB1c2goe3R5cGU6ICd0ZXh0JywgcGF0aDogY3JlYXRlUGF0aChub2RlKX0pO1xuICAgICAgICBzZWFyY2ggPSBgJHtwcmVmaXh9JHsrK2l9YDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtjb250ZW50LCBub2Rlc307XG59O1xuXG5jb25zdCBtYXBVcGRhdGVzID0gKHR5cGUsIHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHtjb250ZW50LCBub2Rlc30gPSB0ZW1wbGF0ZXMuZ2V0KHRlbXBsYXRlKSB8fCBzZXRUZW1wbGF0ZSh0eXBlLCB0ZW1wbGF0ZSk7XG4gIGNvbnN0IGZyYWdtZW50ID0gaW1wb3J0Tm9kZS5jYWxsKGRvY3VtZW50LCBjb250ZW50LCB0cnVlKTtcbiAgY29uc3QgdXBkYXRlcyA9IG5vZGVzLm1hcChoYW5kbGVycywgZnJhZ21lbnQpO1xuICByZXR1cm4ge2NvbnRlbnQ6IGZyYWdtZW50LCB1cGRhdGVzfTtcbn07XG5cbmV4cG9ydCBjb25zdCByZXRyaWV2ZSA9IChpbmZvLCBob2xlKSA9PiB7XG4gIGNvbnN0IHtzdWIsIHN0YWNrfSA9IGluZm87XG4gIGNvbnN0IGNvdW50ZXIgPSB7XG4gICAgYTogMCwgYUxlbmd0aDogc3ViLmxlbmd0aCxcbiAgICBpOiAwLCBpTGVuZ3RoOiBzdGFjay5sZW5ndGhcbiAgfTtcbiAgY29uc3Qgd2lyZSA9IHVucm9sbChpbmZvLCBob2xlLCBjb3VudGVyKTtcbiAgY29uc3Qge2EsIGksIGFMZW5ndGgsIGlMZW5ndGh9ID0gY291bnRlcjtcbiAgaWYgKGEgPCBhTGVuZ3RoKVxuICAgIHN1Yi5zcGxpY2UoYSk7XG4gIGlmIChpIDwgaUxlbmd0aClcbiAgICBzdGFjay5zcGxpY2UoaSk7XG4gIHJldHVybiB3aXJlO1xufTtcblxuY29uc3Qgc2V0VGVtcGxhdGUgPSAodHlwZSwgdGVtcGxhdGUpID0+IHtcbiAgY29uc3QgcmVzdWx0ID0gbWFwVGVtcGxhdGUodHlwZSwgdGVtcGxhdGUpO1xuICB0ZW1wbGF0ZXMuc2V0KHRlbXBsYXRlLCByZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuY29uc3QgdW5yb2xsID0gKGluZm8sIGhvbGUsIGNvdW50ZXIpID0+IHtcbiAgY29uc3Qge3N0YWNrfSA9IGluZm87XG4gIGNvbnN0IHtpLCBpTGVuZ3RofSA9IGNvdW50ZXI7XG4gIGNvbnN0IHt0eXBlLCB0ZW1wbGF0ZSwgdmFsdWVzfSA9IGhvbGU7XG4gIGNvbnN0IHVua25vd24gPSBpID09PSBpTGVuZ3RoO1xuICBpZiAodW5rbm93bilcbiAgICBjb3VudGVyLmlMZW5ndGggPSBzdGFjay5wdXNoKGNyZWF0ZUVudHJ5KHR5cGUsIHRlbXBsYXRlKSk7XG4gIGNvdW50ZXIuaSsrO1xuICB1bnJvbGxBcnJheShpbmZvLCB2YWx1ZXMsIGNvdW50ZXIpO1xuICBsZXQgZW50cnkgPSBzdGFja1tpXTtcbiAgaWYgKCF1bmtub3duICYmIChlbnRyeS50ZW1wbGF0ZSAhPT0gdGVtcGxhdGUgfHwgZW50cnkudHlwZSAhPT0gdHlwZSkpXG4gICAgc3RhY2tbaV0gPSAoZW50cnkgPSBjcmVhdGVFbnRyeSh0eXBlLCB0ZW1wbGF0ZSkpO1xuICBjb25zdCB7Y29udGVudCwgdXBkYXRlcywgd2lyZX0gPSBlbnRyeTtcbiAgZm9yIChsZXQgaSA9IDAsIHtsZW5ndGh9ID0gdXBkYXRlczsgaSA8IGxlbmd0aDsgaSsrKVxuICAgIHVwZGF0ZXNbaV0odmFsdWVzW2ldKTtcbiAgcmV0dXJuIHdpcmUgfHwgKGVudHJ5LndpcmUgPSBwZXJzaXN0ZW50KGNvbnRlbnQpKTtcbn07XG5cbmNvbnN0IHVucm9sbEFycmF5ID0gKGluZm8sIHZhbHVlcywgY291bnRlcikgPT4ge1xuICBsZXQge2EsIGFMZW5ndGh9ID0gY291bnRlcjtcbiAgZm9yIChsZXQgaSA9IDAsIHtsZW5ndGh9ID0gdmFsdWVzLCB7c3VifSA9IGluZm87IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGhvbGUgPSB2YWx1ZXNbaV07XG4gICAgLy8gVGhlIG9ubHkgdmFsdWVzIHRvIHByb2Nlc3MgYXJlIEhvbGUgYW5kIGFycmF5cy5cbiAgICAvLyBBY2NvcmRpbmdseSwgdGhlcmUgaXMgbm8gYGVsc2VgIGNhc2UgdG8gdGVzdC5cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgIGlmIChob2xlIGluc3RhbmNlb2YgSG9sZSlcbiAgICAgIHZhbHVlc1tpXSA9IHVucm9sbChpbmZvLCBob2xlLCBjb3VudGVyKTtcbiAgICBlbHNlIGlmIChpc0FycmF5KGhvbGUpKSB7XG4gICAgICBjb25zdCB7bGVuZ3RofSA9IGhvbGU7XG4gICAgICBjb25zdCBuZXh0ID0gYSArIGxlbmd0aDtcbiAgICAgIHdoaWxlIChhTGVuZ3RoIDwgbmV4dClcbiAgICAgICAgYUxlbmd0aCA9IHN1Yi5wdXNoKG51bGwpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBpbm5lciA9IGhvbGVbaV07XG4gICAgICAgIGlmIChpbm5lciBpbnN0YW5jZW9mIEhvbGUpXG4gICAgICAgICAgaG9sZVtpXSA9IHJldHJpZXZlKHN1YlthXSB8fCAoc3ViW2FdID0gY2FjaGVJbmZvKCkpLCBpbm5lcik7XG4gICAgICAgIGErKztcbiAgICAgIH1cbiAgICB9XG4gICAgYSsrO1xuICB9XG4gIGNvdW50ZXIuYSA9IGE7XG4gIGNvdW50ZXIuYUxlbmd0aCA9IGFMZW5ndGg7XG59O1xuXG4vKipcbiAqIEhvbGRzIGFsbCBuZWNlc3NhcnkgZGV0YWlscyBuZWVkZWQgdG8gcmVuZGVyIHRoZSBjb250ZW50IGZ1cnRoZXIgb24uIFxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUgaG9sZSB0eXBlLCBlaXRoZXIgYGh0bWxgIG9yIGBzdmdgLlxuICogQHBhcmFtIHtzdHJpbmdbXX0gdGVtcGxhdGUgVGhlIHRlbXBsYXRlIGxpdGVyYWxzIHVzZWQgdG8gdGhlIGRlZmluZSB0aGUgY29udGVudC5cbiAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBaZXJvLCBvbmUsIG9yIG1vcmUgaW50ZXJwb2xhdGVkIHZhbHVlcyB0byByZW5kZXIuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBIb2xlKHR5cGUsIHRlbXBsYXRlLCB2YWx1ZXMpIHtcbiAgdGhpcy50eXBlID0gdHlwZTtcbiAgdGhpcy50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbn07XG4iXX0=